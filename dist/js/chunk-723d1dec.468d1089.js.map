{"version":3,"sources":["webpack:///./src/components/ui/AppModal.vue","webpack:///./src/components/ui/AppModal.vue?9eda","webpack:///./src/components/ui/AppPage.vue","webpack:///./src/components/ui/AppPage.vue?948e","webpack:///./src/use/categories.js","webpack:///./src/utils/currency.js","webpack:///./src/views/admin/Product.vue","webpack:///./src/use/leave-guard.js","webpack:///./src/views/admin/Product.vue?31bf","webpack:///./src/components/ui/AppConfirm.vue","webpack:///./src/components/ui/AppConfirm.vue?392c","webpack:///./src/components/ui/AppLoader.vue","webpack:///./src/components/ui/AppLoader.vue?fd03"],"names":["class","$emit","title","emits","props","type","String","render","__scopeId","back","to","center","required","Boolean","default","setup","document","useCategories","store","useStore","getters","length","dispatch","formatter","Intl","NumberFormat","currency","style","value","format","for","loading","product","src","img","alt","width","update","id","price","count","category","categories","c","key","confirm","hasChanges","remove","leave","navigate","useLeaveGuard","router","useRouter","ref","canLeave","leaveTo","push","onBeforeRouteLeave","path","initial","route","params","find","name","components","AppLoader","AppPage","AppConfirm","AppModal"],"mappings":"+MAEOA,MAAM,S,8GADX,eAA0D,OAArDA,MAAM,iBAAkB,QAAK,+BAAE,EAAAC,MAAK,aACzC,eAIM,MAJN,EAIM,CAHM,EAAAC,O,iBAAV,eAAiC,sBAAb,EAAAA,OAAK,I,sBAEzB,eAAQ,uB,OAKG,GACbC,MAAO,CAAC,SACRC,MAAO,CACLF,MAAO,CACLG,KAAMC,UCXZ,EAAOC,OAASA,EAChB,EAAOC,UAAY,kBAEJ,U,uICLRR,MAAM,e,iBAC8B,uB,GAGnCA,MAAM,c,wIAJmB,EAAAS,M,iBAA/B,eAEM,MAFN,EAEM,CADJ,eAAwE,GAA3DC,GAAG,IAAIV,MAAM,c,YAAa,iBAAmB,C,qCAE5D,eAOM,OAPAA,MAAK,gBAAY,EAAAW,U,CACrB,eAGK,KAHL,EAGK,C,+BAFH,eAA6B,2BAAd,EAAAT,OAAK,G,wBACpB,eAAsB,qBAGxB,eAAQ,qB,WAKG,GACbE,MAAO,CACLF,MAAO,CACLG,KAAMC,OACNM,UAAU,GAEZH,KAAM,CACJJ,KAAMQ,QACNC,SAAS,GAEXH,OAAQ,CACNN,KAAMQ,QACNC,SAAS,IAGbC,MAfa,SAePX,GACAA,EAAMF,QACRc,SAASd,MAAT,UAAoBE,EAAMF,MAA1B,mBC7BN,EAAOK,OAASA,EAChB,EAAOC,UAAY,kBAEJ,U,0GCJR,SAAeS,IAAtB,+B,8DAAO,uGACCC,EAAQC,iBAEsC,IAAhDD,EAAME,QAAQ,uBAAuBC,OAHpC,gCAIGH,EAAMI,SAAS,iBAJlB,2C,8DCFP,sCAAMC,EAAY,IAAIC,KAAKC,aAAa,QAAS,CAACC,SAAU,MAAOC,MAAO,aAEnE,SAASD,EAASE,GACvB,OAAOL,EAAUM,OAAOD,K,wICEf5B,MAAM,gB,EACT,eAAmC,SAA5B8B,IAAI,SAAQ,YAAQ,G,GAGxB9B,MAAM,gB,EACT,eAAoC,SAA7B8B,IAAI,OAAM,eAAW,G,GAGzB9B,MAAM,gB,EACT,eAA+B,SAAxB8B,IAAI,SAAQ,QAAI,G,GAGpB9B,MAAM,gB,EACT,eAA+C,SAAxC8B,IAAI,SAAQ,wBAAoB,G,GAGpC9B,MAAM,gB,EACT,eAAqC,SAA9B8B,IAAI,UAAS,aAAS,G,SASvB9B,MAAM,MAAMK,KAAK,U,SAGlBL,MAAM,0B,mMAjCC,EAAA+B,S,iBAAlB,eAAwC,YACI,EAAAC,S,iBAA5C,eA+BW,G,MA/BA9B,MAAO,EAAA8B,QAAQ9B,O,YACxB,iBAAyD,CAAzD,eAAyD,OAAnD+B,IAAK,EAAAD,QAAQE,IAAMC,IAAK,EAAAH,QAAQ9B,MAAOkC,MAAM,O,sBACnD,eA4BO,QA5BA,SAAM,8CAAU,EAAAC,QAAA,EAAAA,OAAA,qBAAM,e,CAC3B,eAGM,MAHN,EAGM,CAFJ,E,eACA,eAAsD,SAA/ChC,KAAK,OAAOiC,GAAG,Q,qDAAiB,EAAAN,QAAQ9B,MAAK,K,mBAAb,EAAA8B,QAAQ9B,WAEjD,eAGM,MAHN,EAGM,CAFJ,E,eACA,eAAkD,SAA3CG,KAAK,OAAOiC,GAAG,M,qDAAe,EAAAN,QAAQE,IAAG,K,mBAAX,EAAAF,QAAQE,SAE/C,eAGM,MAHN,EAGM,CAFJ,E,eACA,eAA+D,SAAxD7B,KAAK,SAASiC,GAAG,Q,qDAAwB,EAAAN,QAAQO,MAAK,K,mBAAb,EAAAP,QAAQO,W,WAAxB,QAElC,eAGM,MAHN,EAGM,CAFJ,E,eACA,eAA+D,SAAxDlC,KAAK,SAASiC,GAAG,Q,qDAAwB,EAAAN,QAAQQ,MAAK,K,mBAAb,EAAAR,QAAQQ,W,WAAxB,QAElC,eAOM,MAPN,EAOM,CANJ,E,eACA,eAIS,UAJDF,GAAG,S,qDAAkB,EAAAN,QAAQS,SAAQ,K,qBAC3C,eAE4D,2BAA5C,EAAAC,YAAU,SAAfC,G,wBAFX,eAE4D,UADvDf,MAAOe,EAAEtC,KACeuC,IAAKD,EAAEL,I,eAAMK,EAAEzC,OAAK,gB,qBAHtB,EAAA8B,QAAQS,cAOvC,eAAiF,UAAzEzC,MAAM,aAAaK,KAAK,SAAU,QAAK,+BAAE,EAAAwC,SAAO,KAAS,WACzB,EAAAC,Y,iBAAxC,eAAqE,SAArE,EAAoD,a,oEAGxD,eAEK,KAFL,EAA0C,yB,iBAI1C,eAMW,QANDpC,GAAG,QAAM,CAET,EAAAmC,S,iBADR,eAIsB,G,MAFpB3C,MAAM,iBACL,SAAM,+BAAE,EAAA2C,SAAO,IACf,UAAS,EAAAE,Q,kEAGd,eAMW,QANDrC,GAAG,QAAM,CAEP,EAAAsC,O,iBADV,eAI0B,G,MAFtB9C,MAAM,6DACL,SAAM,+BAAE,EAAA8C,OAAK,IACb,UAAS,EAAAC,U,4LC/CX,SAASC,EAAcJ,GAC5B,IAAMK,EAASC,iBACTJ,EAAQK,gBAAI,GACZC,EAAWD,gBAAI,GACfE,EAAUF,eAAI,MAEdJ,EAAQ,yDAAG,qGACfD,EAAMpB,OAAQ,EACd0B,EAAS1B,OAAQ,EAFF,SAGTuB,EAAOK,KAAKD,EAAQ3B,OAHX,2CAAH,qDAoBd,OAdA6B,gBAAmB,SAAA/C,GACjB,QAAI4C,EAAS1B,SAITkB,EAAWlB,QACboB,EAAMpB,OAAQ,EACd2B,EAAQ3B,MAAQlB,EAAGgD,MACZ,OAMJ,CAACV,QAAOC,YDoCF,OACblC,MADa,WAEX,IAKI4C,EALEC,EAAQ,iBACRT,EAAS,iBACTjC,EAAQ,iBACRc,EAAU,eAAI,IACda,EAAU,gBAAI,GAGdd,EAAU,gBAAI,GAEpB,eAAS,wCAAC,8GACF,iBADE,uBAEQb,EAAMI,SAAS,kBAAmBsC,EAAMC,OAAOvB,IAFvD,OAERqB,EAFQ,OAGR3B,EAAQJ,MAAR,kBAAoB+B,GACpB5B,EAAQH,OAAQ,EAJR,4CAOV,IAAMc,EAAa,gBAAS,kBAAMxB,EAAME,QAAQ,0BAE1CqB,EAAW,gBAAS,kBACxBC,EAAWd,MAAMkC,MAAK,SAAAnB,GAAA,OAAKA,EAAEtC,OAAS2B,EAAQJ,MAAMa,eAGhDK,EAAa,gBAAS,kBAC1Bd,EAAQJ,MAAM1B,QAAUyD,EAAQzD,OAChC8B,EAAQJ,MAAMM,MAAQyB,EAAQzB,KAC9BF,EAAQJ,MAAMW,QAAUoB,EAAQpB,OAChCP,EAAQJ,MAAMY,QAAUmB,EAAQnB,OAChCR,EAAQJ,MAAMa,WAAakB,EAAQlB,YAG/BM,EAAK,yDAAI,qGACbF,EAAQjB,OAAQ,EADH,SAEPV,EAAMI,SAAS,iBAAkBsC,EAAMC,OAAOvB,IAFvC,OAGba,EAAOK,KAAK,CAACO,KAAM,kBAHN,2CAAJ,qDAML1B,EAAK,yDAAI,8GACGnB,EAAMI,SAAS,iBAAkB,eAAMU,EAAQJ,QADlD,OACb+B,EADa,OAEb3B,EAAQJ,MAAR,kBAAoB+B,GAFP,2CAAJ,qDAKX,uBACE5B,UACAC,UACAN,WAAA,KACAe,WACAC,aACAK,SACAF,UACAR,SACAS,cACGI,EAAcJ,KAGrBkB,WAAY,CACVC,YAAA,KAAWC,UAAA,KAASC,aAAA,OExHxB,EAAO5D,OAASA,EAChB,EAAOC,UAAY,kBAEJ,gB,0KCLb,eAGW,GAHAN,MAAO,EAAAA,MAAQ,QAAK,+BAAE,EAAAD,MAAK,a,YACpC,iBAAiF,CAAjF,eAAiF,UAAzED,MAAM,cAAe,QAAK,+BAAE,EAAAC,MAAK,WAAY,EAAAA,MAAK,aAAY,MACtE,eAAgE,UAAxDD,MAAM,aAAc,QAAK,+BAAE,EAAAC,MAAK,aAAY,W,iCAMzC,GACbE,MAAO,CAAC,UAAW,UACnBC,MAAO,CAAC,SACR4D,WAAY,CAACI,WAAA,OCTf,EAAO7D,OAASA,EAChB,EAAOC,UAAY,kBAEJ,U,+HCLRR,MAAM,U,wEAAX,eAA0B,MAA1B,MAIe,KCFjB,EAAOO,OAASA,EAChB,EAAOC,UAAY,kBAEJ","file":"js/chunk-723d1dec.468d1089.js","sourcesContent":["<template>\n  <div class=\"modal-backdrop\" @click=\"$emit('close')\"></div>\n  <div class=\"modal\">\n    <h3 v-if=\"title\">{{ title }}</h3>\n\n    <slot />\n  </div>\n</template>\n\n<script>\nexport default {\n  emits: ['close'],\n  props: {\n    title: {\n      type: String\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>","import { render } from \"./AppModal.vue?vue&type=template&id=5e9b7419&scoped=true\"\nimport script from \"./AppModal.vue?vue&type=script&lang=js\"\nexport * from \"./AppModal.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-5e9b7419\"\n\nexport default script","<template>\n  <div class=\"breadcrumbs\" v-if=\"back\">\n    <router-link to=\"/\" class=\"text-white\">Вернуться к товарам</router-link>\n  </div>\n  <div :class=\"['card', {center}]\">\n    <h1 class=\"card-title\">\n      <span v-once>{{title}}</span>\n      <slot name=\"header\" />\n    </h1>\n\n    <slot />\n  </div>\n</template>\n\n<script>\nexport default {\n  props: {\n    title: {\n      type: String,\n      required: true\n    },\n    back: {\n      type: Boolean,\n      default: false\n    },\n    center: {\n      type: Boolean,\n      default: false\n    }\n  },\n  setup(props) {\n    if (props.title) {\n      document.title = `${props.title} | Vue Лавка`\n    }\n  }\n}\n</script>\n\n<style scoped>\n\n</style>","import { render } from \"./AppPage.vue?vue&type=template&id=b841083e&scoped=true\"\nimport script from \"./AppPage.vue?vue&type=script&lang=js\"\nexport * from \"./AppPage.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-b841083e\"\n\nexport default script","import {useStore} from 'vuex'\n\nexport async function useCategories() {\n  const store = useStore()\n\n  if (store.getters['category/categories'].length === 0) {\n    await store.dispatch('category/load')\n  }\n}\n","const formatter = new Intl.NumberFormat('ru-RU', {currency: 'RUB', style: 'currency'})\n\nexport function currency(value) {\n  return formatter.format(value)\n}","<template>\n  <app-loader v-if=\"loading\"></app-loader>\n  <app-page :title=\"product.title\" v-else-if=\"product\">\n    <img :src=\"product.img\" :alt=\"product.title\" width=\"150\">\n    <form @submit.prevent=\"update\">\n      <div class=\"form-control\">\n        <label for=\"title\">Название</label>\n        <input type=\"text\" id=\"title\" v-model=\"product.title\">\n      </div>\n      <div class=\"form-control\">\n        <label for=\"img\">Изображение</label>\n        <input type=\"text\" id=\"img\" v-model=\"product.img\">\n      </div>\n      <div class=\"form-control\">\n        <label for=\"price\">Цена</label>\n        <input type=\"number\" id=\"price\" v-model.number=\"product.price\">\n      </div>\n      <div class=\"form-control\">\n        <label for=\"count\">Количество на складе</label>\n        <input type=\"number\" id=\"count\" v-model.number=\"product.count\">\n      </div>\n      <div class=\"form-control\">\n        <label for=\"status\">Категория</label>\n        <select id=\"status\" v-model=\"product.category\">\n          <option\n              :value=\"c.type\"\n              v-for=\"c in categories\" :key=\"c.id\">{{c.title}}</option>\n        </select>\n      </div>\n\n      <button class=\"btn danger\" type=\"button\" @click=\"confirm = true\">Удалить</button>\n      <button class=\"btn\" type=\"submit\" v-if=\"hasChanges\">Обновить</button>\n    </form>\n  </app-page>\n  <h3 v-else class=\"text-center text-white\">\n    Товара не найден.\n  </h3>\n\n  <teleport to=\"body\">\n    <AppConfirm\n      v-if=\"confirm\"\n      title=\"Удалить товар?\"\n      @reject=\"confirm = false\"\n      @confirm=\"remove\" />\n  </teleport>\n\n  <teleport to=\"body\">\n    <AppConfirm\n        v-if=\"leave\"\n        title=\"Есть несохраненные изменения. Вы хотите покинуть страницу?\"\n        @reject=\"leave = false\"\n        @confirm=\"navigate\" />\n  </teleport>\n</template>\n\n<script>\nimport {ref, onMounted, computed, toRaw, watch} from 'vue'\nimport {useStore} from 'vuex'\nimport {useRoute, useRouter} from 'vue-router'\nimport AppPage from '../../components/ui/AppPage'\nimport AppLoader from '../../components/ui/AppLoader'\nimport AppConfirm from '../../components/ui/AppConfirm'\nimport {currency} from '../../utils/currency'\nimport {useCategories} from '../../use/categories'\nimport {useLeaveGuard} from '../../use/leave-guard'\n\nexport default {\n  setup() {\n    const route = useRoute()\n    const router = useRouter()\n    const store = useStore()\n    const product = ref({})\n    const confirm = ref(false)\n    let initial\n\n    const loading = ref(true)\n\n    onMounted(async () => {\n      await useCategories()\n      initial = await store.dispatch('product/loadOne', route.params.id)\n      product.value = {...initial}\n      loading.value = false\n    })\n\n    const categories = computed(() => store.getters['category/categories'])\n\n    const category = computed(() =>\n      categories.value.find(c => c.type === product.value.category)\n    )\n\n    const hasChanges = computed(() =>\n      product.value.title !== initial.title ||\n      product.value.img !== initial.img ||\n      product.value.price !== initial.price ||\n      product.value.count !== initial.count ||\n      product.value.category !== initial.category\n    )\n\n    const remove = async () => {\n      confirm.value = false\n      await store.dispatch('product/remove', route.params.id)\n      router.push({name: 'AdminProducts'})\n    }\n\n    const update = async () => {\n      initial = await store.dispatch('product/update', toRaw(product.value))\n      product.value = {...initial}\n    }\n\n    return {\n      loading,\n      product,\n      currency,\n      category,\n      categories,\n      remove,\n      confirm,\n      update,\n      hasChanges,\n      ...useLeaveGuard(hasChanges)\n    }\n  },\n  components: {\n    AppLoader, AppPage, AppConfirm\n  }\n}\n</script>\n\n<style scoped>\n\n</style>","import {onBeforeRouteLeave} from 'vue-router'\nimport {ref} from 'vue'\nimport {useRouter} from 'vue-router'\n\nexport function useLeaveGuard(hasChanges) {\n  const router = useRouter()\n  const leave = ref(false)\n  const canLeave = ref(false)\n  const leaveTo = ref(null)\n\n  const navigate = async ( ) => {\n    leave.value = false\n    canLeave.value = true\n    await router.push(leaveTo.value)\n  }\n\n  onBeforeRouteLeave(to => {\n    if (canLeave.value) {\n      return true\n    }\n\n    if (hasChanges.value) {\n      leave.value = true\n      leaveTo.value = to.path\n      return false\n    }\n\n    return true\n  })\n\n  return {leave, navigate}\n}","import { render } from \"./Product.vue?vue&type=template&id=6db0b58e&scoped=true\"\nimport script from \"./Product.vue?vue&type=script&lang=js\"\nexport * from \"./Product.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-6db0b58e\"\n\nexport default script","<template>\n  <AppModal :title=\"title\" @close=\"$emit('reject')\">\n    <button class=\"btn primary\" @click=\"$emit('confirm'),$emit('reject')\">Да</button>\n    <button class=\"btn danger\" @click=\"$emit('reject')\">Нет</button>\n  </AppModal>\n</template>\n\n<script>\nimport AppModal from './AppModal'\nexport default {\n  emits: ['confirm', 'reject'],\n  props: ['title'],\n  components: {AppModal}\n}\n</script>\n\n<style scoped>\n\n</style>","import { render } from \"./AppConfirm.vue?vue&type=template&id=185ec484&scoped=true\"\nimport script from \"./AppConfirm.vue?vue&type=script&lang=js\"\nexport * from \"./AppConfirm.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-185ec484\"\n\nexport default script","<template>\n  <div class=\"loader\"></div>\n</template>\n\n<script>\n  export default {\n\n  }\n</script>\n\n<style scoped>\n\n</style>","import { render } from \"./AppLoader.vue?vue&type=template&id=4ce08c3c&scoped=true\"\nimport script from \"./AppLoader.vue?vue&type=script&lang=js\"\nexport * from \"./AppLoader.vue?vue&type=script&lang=js\"\nscript.render = render\nscript.__scopeId = \"data-v-4ce08c3c\"\n\nexport default script"],"sourceRoot":""}